%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{粗視化分子動力学(CGMD)法}
\subsection{運動方程式}
本研究におけるCGMD法では、粘土分子の単位構造とそこに水和された水分子を一つの粗視化粒子として扱う．
ここで，全部で$N$個の粗視化粒子のうち第$i$番目のものの質量を$m_i$，
速度ベクトルを$\fat{v}_i=\dot{\fat{x}}_i$，位置ベクトルを$\fat{x}_i$とすれば，
粒子$i$の運動方程式は
\begin{equation}
	m_i \dot {\fat{v}}_i =\fat{f}_i ,\ \ 
	\dot{\fat{x}}_i = \fat{v}_i, \ \ ( i =1,2,\cdots N )
	\label{eqn:eq_mot}
\end{equation}
と表される．ただし，$\fat{f}_i$は，粒子$i$に作用する力のベクトルを意味する．
また，素視化粒子の質量は，粘土分子の単位構造の質量として
\begin{equation}
	m=2.468\times 10 ^{-24}[{\rm kg}]
	\label{eqn:mass}
\end{equation}
と与えられる．$\fat{f}_i$は分子間力$\fat{f}_i^{U}$と分子内力$\fat{f}_i^{K}$の和として
\begin{equation}
	\fat{f}_i=\fat{f}_i^U+\fat{f}_i^K
	\label{eqn:f_tot}
\end{equation}
と書くことができる．粒子に作用するこれらの力の与え方は既報(2018年度共同研究報告書)
に述べた通りであり，水和水の多寡は分子間力$f_i^U$に含まれるパラメータ$\sigma$で表現される．
本年度の研究では，水和水量の増減による膨潤や膨潤圧の発生に関するシミュレーションを行う．
その方法を示すために，ここででは$\fat{f}_i^U$の詳細を述べる．その後，いかにして粘土含水系内での水分配置や，
水分の総量量を更新するかについて説明する．\\

素視化粒子間に作用する分子間力は，レナード-ジョーンズ(LJ)型のペアポテンシャル:
\begin{equation}
	U(\fat{x}_i,\fat{x}_j; \sigma) 
	= 4 \varepsilon 
	\left\{ 
	\left(\frac{\sigma}{r_{ij}}\right)^{12}
	-
	\left(\frac{\sigma}{r_{ij}}\right)^6
	\right\}, \ \ \left( r_{ij}=\left| \fat{x}_i-\fat{x}_j\right| \right)
	\label{eqn:LJ}
\end{equation}
を用いて次のように与える．
\begin{equation}
	\fat{f}_i^U(\fat{x}_i)
	=
	-\nabla_{x_i} 
	\left\{ 
		\sum_{j=1, \, j \neq i}^N U\left(\fat{x}_i,\,\fat{x}_j; \sigma \right)
	\right\}
	\label{eqn:fiU}
\end{equation}
ここに$\fat{x}_i$と$\fat{x}_j$は，現在時刻における粒子$i$と粒子$j$の位置ベクトルを，
$\varepsilon$と$\sigma$はLJポテンシャルのパラメータを，$\nabla_{x_i}=\frac{\partial}{\partial \fat{x}_i}$
はLJポテンシャルの 第一引数$\fat{x}_i$に関する勾配を表す．
LJポテンシャルの特性距離を与えるパラメータ$\sigma$は，素視化粒子間の接近限界，すなわち，粘土分子が積層
した際の層間距離を定める．従って，これを当該粒子に水和した水分の量を表す変数と考えることができる．
なお，モンモリロナイトの膨潤状態と$\sigma$の対応は，X線回折試験によって得られた粘土層間距離から
概ね表\ref{tbl:tbl_sig}のようになる．$\sigma$の値は計算途上で適宜更新され，$0.9$nm以上の値をとる．
一方，$\varepsilon$は，粗視化粒子間相互作用の強さを決定するパラメータであり、
事前に行った全原子MDシミュレーションの結果を参考に
\begin{equation}
	\varepsilon=1.0\times 10^{-19}[{\rm Nm}]
	\label{eqn:LJ_eps}
\end{equation}
と与え，こちらは定数としている．
\begin{table}[h]
	\begin{center}
	\caption{分子間相互作用ポテンシャルにおける特性距離と膨潤状態の対応.}
	\vspace{3mm}
	\begin{tabular}{c||c|c|c|c|c}
		膨潤状態 & 0層 & 1層 & 2層 & 3層 & $\cdots$\\
		\hline
		特性距離$\sigma$[{\rm nm}]& 0.9 & 1.2 & 1.5 & 1.8 & $\cdots$ \\
	\end{tabular}
	\label{tbl:tbl_sig}
	\end{center}
\end{table}
\subsection{特性距離の設定}
粘土分子表面に水和した水分の移動を許容する場合，空間的に水分量の偏りが生じる．
そのような状況を計算上で表現するためには，水和水量を与えるパラメータ$\sigma$を
粒子ペア毎に設定する必要がある．また，粘土分子の一方の面と他方の面に水和した
水分量が異なる場合，粘土分子の上下いずれのと相互作用するかを区別して
ペアポテンシャルを評価する必要がある．これらのことを考慮し，本研究では以下の
手順で$\sigma$の値を設定する．

粒子$i$と粒子$j$に関するペアポテンシャル(\ref{eqn:LJ})の特性距離$\sigma$について考える．
いま，粒子$i$が属する粘土分子の一方の面を$S^+$，他方の面を$S^-$とし，位置$\fat{x}_i(\in S^+)$
における$S^+$の法線ベクトルを$\fat{n}_i$と表す．
また，粘土分子の厚さは幅に比べて十分小さいと考え，$\fat{x}_i$における$S^-$(裏面側)の
法線ベクトルを$-\fat{n}$とする．ここで，粒子$i$の$S^+$側に水和した水和水層の厚さを
$s_i^+$，$S^-$側の厚さを$s_i^-$と書く．
このとき，粒子$j$が$\fat{n}^+$の側にある場合は$S^+$と，$-\fat{n}$の側にある場合は
$S^-$と相互作用すると考えることができる．
そこで，該当する側の面を水和水層厚$s_i$を
\begin{equation}
	s_i=\left\{
	\begin{array}{cc}
		s_i^+ & (h(\fat{x}_i,\fat{x}_j) \ge 0)\\
		s_i^- & (h(\fat{x}_j,\fat{x}_i) <0)
	\end{array}
	\right.
	\label{eqn:si_switch}
\end{equation}
\begin{equation}
	h(\fat{x}_i,\fat{x}_j) =\fat{n}_i\cdot \left(\fat{x}_j-\fat{x}_i\right)
	\label{eqn:h_sgn}
\end{equation}
で選択し，粒子$i$と粒子$j$の間のペアポテンシャルの特性距離$\sigma$を
\begin{equation}
	\sigma=s_i+s_j+\sigma_0
	\label{eqn:sig_ij}
\end{equation}
で与える．ただし，$\sigma_0(=0.9)$[nm]は無水時(0層膨潤状態)の層間距離を表す．
このようにすることで，粘土分子の表裏面を区別し，位置に応じて
異なる水和水の分布を表現することができる．
%--------------------
\begin{figure}[h]
	\begin{center}
%	\includegraphics[width=0.5\linewidth]{Figs/fig7.eps} 
	\end{center}
	\caption{
		粗視化粒子の向きを表すために用いる単位接線
		$\hat{\fat{t}}_i,\hat{\fat{t}}_j$
		および, 単位法線ベクトル.
		$\hat{\fat{n}}_i,\hat{\fat{n}}_j$. 
		$\theta_{ij}$は粒子位置$\fat{x}_i$から$\fat{x}_j$を望む方向を，
		$\theta_{ji}$は$\fat{x}_j$から$\fat{x}_i$を望む方向を，
		それぞれの粒子位置における接線ベクトルから測ったときの角度を表す．
	} 
	\label{fig:fig9}
\end{figure}
%--------------------
\subsection{時間ステッピング}
CGMD法では粒子位置$\fat{x}_i$と速度$\fat{v}_i$に加え，水和層の厚さ$s_i^\pm$が
系の時間発展に伴い更新の対象となる．以下，これらの未知量を
\begin{equation}
	\fat{V}=\left\{ \fat{v}_1,\, \fat{v}_2,\, \dots \fat{v}_N \right\}
	\label{eqn:defV}
\end{equation}
\begin{equation}
	\fat{X}=\left\{ \fat{x}_1,\, \fat{x}_2,\, \dots \fat{x}_N \right\}
	\label{eqn:defV}
\end{equation}
\begin{equation}
	\fat{\Sigma}=\left\{ \fat{s}_1^\pm,\, \fat{s}_2^\pm,\, \dots \fat{s}_N^\pm \right\}
	\label{eqn:defV}
\end{equation}
と表し，各々の時間ステッピングにともなう増分を$\Delta \fat{V},\Delta \fat{X}$，
および$\Delta \fat{\Sigma}$と書く．これらの内、位置と速度の更新は運動方程式(\ref{eqn:eq_mot})を差分法で離散化して時間積分することによって行う．
離散化のための差分スキームにはleapfrog法による中央差分を用いる．
なお，$\fat{V}$と$\fat{X}$の更新時には$\fat{\Sigma}$を一定としておく．すなわち，
\begin{equation}
	\left( \fat{V},\,\fat{X} \right)
	\rightarrow 
	\left( \fat{V},\,\fat{X} \right)
	+
	\left. \left( \Delta \fat{V},\, \Delta \fat{X} \right) \right|_{\fat{\Sigma}}
	\label{eqn:vx_update}
\end{equation}
とする. 一方，水分分布$\fat{\Sigma}$の更新にはモンテカルロ法を用い，その際$(\fat{V},\fat{X})$は一定とする．
すなわち
\begin{equation}
	\fat{\Sigma} \rightarrow \fat{\Sigma} + \left. \Delta \fat{\Sigma} \right|_{\fat{V},\fat{X}}
	\label{eqn:s_update}
\end{equation}
とする．モンテカルロ法では疑似乱数を用いて系のエネルギー$U(\fat{V},\fat{X},\fat{\Sigma})$が
低減する方向へ繰返し状態を更新する．ここでは水分の移動に関して二種類の状態更新を行う．
1つ目の状態更新では，粗視化粒子のペアを無作為に選択して，これらの粒子間で水分の授受を行うべきかを判定する．
その際，水分授受が発生したの仮定の元でエネルギーの増減$\Delta U$を計算する．
$\Delta U<0$の場合には，実際に(\ref{eqn:s_update})のように水分の状態を更新する．
この方法では系内の水分量は一定に保った状態で水分分布が変更される．
2つ目の状態更新では，一つの粗視化粒子を無作為に選択しその水分量が所定量だけ増減したと仮定する．
その仮定の元で生じるエネルギー変化$\Delta U$を計算し，$\Delta U<0$の場合に実際に当該粒子が保持する
水分量を変化させる．この状態更新では，系内に含まれる水分の総量を変化させることができる。
次節ではモンテカルロ法におけるエネルギー$U$の具体的な評価方法を述べる．
\subsection{水分量と水分分布に関するエネルギー}
水分移動に関する全エネルギーを$E$とし，これを
\begin{equation}
	E=U_{LJ} +U_{hyd} + U_n
	\label{eqn:}
\end{equation}
と表す．ここで$U_{LJ}$は粗視化粒子間相互作用の， 
$U_{hyd}$は水分子と粘土分子の水和による相互作用を，
$U_N$は系内に含まれる水分子数の増減に関するエネルギーをそれぞれ表す．
このうち$U_{LJ}$は式(\ref{eqn:LJ})を用い，
\begin{equation}
	U_{LJ}=\sum_{i\neq j} U(\fat{x}_i,\fat{x}_j;\sigma)
	\label{eqn:}
\end{equation}
で与えられ，運動方程式の積分でも考慮されているものである．
一方、$U_{hyd}$は粗視化粒子内のエネルギーで、運動方程式や粒子間相互作用
ポテンシャルには含まれていない．そこで，$U_{hyd}$は後述する方法により
別途モデル化して与える。残る$U_N$は，水分量の増減によって変化する
自由エネルギーであり、直接モデル化や計算することが難しい．
しかしながら，モンテカルロ法では状態更新に伴うエネルギーの増減だけが計算できればよいため、
必ずしも$U_N$そのものを計算できる必要はない。
そこで、$U_N$の増分$\Delta U_n$を
\begin{equation}
	\Delta U_n =\mu \Delta n
	\label{eqn:}
\end{equation}
と表す。ここに，$\mu$は外界(水分溜)の化学ポテンシャルを，
$n$は水分子の総数を表す．
なお，実際のCGMD法計算では，水分子数ではなく水和水の層厚$s=s^{+}$あるいは$s=s^{-}$を変化させる. 
そのため，$\Delta U_n$の計算にあたり，
\begin{equation}
	\Delta U_n =\tilde \mu \Delta s
	\label{eqn:}
\end{equation}
となるように，$\mu$ではなく
\begin{equation}
	\tilde \mu =\mu \frac{\Delta n}{\Delta s}
	\label{eqn:}
\end{equation}
を与えることとした．
\subsection{水和エネルギーモデル}
粒子$i$の$S^\beta$面に関する水和エネルギーを$u^\beta_i(\beta=+,-)$とする．
このとき， 系全体の水和エネルギーは
\begin{equation}
	U_{hyd}=\sum_{i=1}^N\sum_{\beta=+,-} u_i^{\beta}
	\label{eqn:}
\end{equation}
で与えられる．いま，$u^+_i$と$u^-_i$を与える関数は粒子や面の向きに依らないと考えてよく，
\begin{equation}
	u^\beta_i= u(s^\beta), \ \ (s^\beta>0,\, \beta=+,-)
	\label{eqn:}
\end{equation}
としてよい．そこで，$u$を水和水層の厚さ$s$の関数としてモデル化する．
$u(s)$は$s$に対して大局的には減少する有界な関数である．
また$u(0)=0$としてよいため，ここでは次の指数関数を用いて与える．
\begin{equation}
	u(s)=u_{\infty} \left(1-e^{-\gamma s} \right)
	\label{eqn:u_s}
\end{equation}
ここに$u_{\infty}$は$s\rightarrow \infty$(無限膨潤)での水和エネルギーを表す．
$\gamma$は
\begin{equation}
	u'(s)=\frac{du}{ds}=\gamma u_{\infty} e^{-\gamma s}
	\label{eqn:ud_s}
\end{equation}
より，水和エネルギーの$s$に対する変化率を決めるパラメータである。
ここでは，$u'(s)$の半減距離$s=s_b$を与え，
\begin{equation}
	\frac{u'\left(s_b\right)}{u'(0)}=e^{-\gamma s_b}=\frac{1}{2} 
	\ \ \Rightarrow \ \
	\gamma=\frac{\log 2}{s_b}
	\label{eqn:}
\end{equation}
から$\gamma$の値を決定した．
$u(s)$と$u'(s)$は図\ref{fig:fig0}に示すような形状をしている．
このグラフでは横軸を半減距離$s_b$で無次元化して表示しているため，
$u(s),u'(s)$とも$s/s_b=1$において$u(0),u'(0)$から値が半減している
様子が示されている．
%--------------------
\begin{figure}[h]
	\begin{center}
	\includegraphics[width=1.0\linewidth]{Figs/fig0.eps} 
	\end{center}
	\caption{
		水和エネルギー$u$とその導関数$u'$．
		$s$は水和水層の厚さ，$s_b$は$-u'$の半減距離，
		$\gamma$は減衰率($e-\gamma s_b=1/2$)を表す．
	} 
	\label{fig:fig0}
\end{figure}
%--------------------
